{{ define "inc" }}{{ len (printf "%*s " . "") }}{{ end -}}
{{ define "dec" }}{{ len (slice (printf "%*s" . "") 1) }}{{ end -}}

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="/static/style.css" />
    <link rel="icon" href="/static/favicon.svg" />
    <title>{{ .query }}</title>
  </head>
  <body>
    <form class="search-row-container" method="get" action="search">
      <input
        type="text"
        name="q"
        class="search-input search-row-input"
        value="{{ .query }}"
        autofocus
        required
      />
      <input type="text" value="{{ .type }}" name="type" hidden />
      <label>
        <input type="submit" class="search-row-submit" value="Search" hidden />
        <img id="search-icon" src="/static/favicon.svg" />
      </label>
    </form>
    <section id="providers">
      <a href="/search?q={{ .query }}&type=text">
        <img src="/static/text.svg" />
        <span>General</span>
      </a>
      <a href="/search?q={{ .query }}&type=image">
        <img src="/static/image.svg" />
        <span>Image</span>
      </a>
      <a href="/search?q={{ .query }}&type=code">
        <img src="/static/code.svg" />
        <span>Code</span>
      </a>
      <a href="/search?q={{ .query }}&type=video">
        <img src="/static/video.svg" />
        <span>Video</span>
      </a>
      <a href="/search?q={{ .query }}&type=music">
        <img src="/static/music.svg" />
        <span>Music</span>
      </a>
    </section>
    {{ if .timeTaken }}
    <p>Fetched the results in {{ .timeTaken }}</p>
    {{ end }} {{ if .error }}
    <section id="error">
      <h1>404</h1>
      <p>{{ .error }}</p>
    </section id="general">
    {{ else }} 
    <section id="details">
      {{ with .dict }} {{ if not (eq .Definition "") }}
    <div id="dict" class="container">
      <span>{{ .PartOfSpeech }}</span>
      <p>{{ .Definition }}</p>
      <div>{{ .Example }}</div>
    </div>
    {{ end }} {{ end }} {{ with .wiki }} {{ if not (eq .Description "") }}
    <a href="{{ .Url }}" id="wiki" class="container">
      {{ if not (eq .Thumbnail "") }}
      <img src="{{ .Thumbnail }}" />
      {{ end }}
      <p>{{ .Description }}</p>
    </a>
    {{ end }} {{ end }} {{ if not (eq .weather "") }}
    <div id="weather" class="container">{{ .weather }}</div>
    {{ end }}
    </section>
    <section id="results">
      {{ range .results }}
      <a href="{{ .Url }}" class="container">
        <p>{{ .Short }}</p>
        <h1>{{ .Title }}</h1>
        <p>{{ .Description }}</p>
      </a>
      {{ end }}
    </section>
    <section id="code">
      {{ range .code }}
      <a href="{{ .Url }}" class="container">
        <h3>{{ .Title }}</h3>
        <p>
          {{ .AnswerCount }}{{ if .IsAnswered }} ✔{{ end }} ⋅ {{
          .CreationDateStr }} ⋅ {{ .ScoreStr }} / {{ .ViewCountStr }}
        </p>
      </a>
      {{ end }}
    </section>
    <section id="images">
      {{ range .images }}
      <div class="img-container">
        <a href="{{ .Media }}">
          <img src="{{ .Thumbnail }}" alt="{{ .Title }}" />
        </a>
        <a class="img-title" href="{{ .Url }}">{{ .Title }}</a>
      </div>
      {{ end }}
    </section>
    <section id="videos">
      {{ range .videos }}
      <a href="{{ .Url }}">
        <span class="thumbnail-container">
          <img src="{{ .Thumbnail }}" alt="" />
          <span>{{ .DurationString }}</span>
        </span>
        <h3>{{ .Title }}</h3>
        {{ if not (eq .Views 0) }}
        <p>{{ .Uploader }} ⋅ {{ .UploadDate }} ⋅ {{ .ViewsString }}</p>
        {{ else }}
        <p>{{ .Uploader }}</p>
        {{ end }}
      </a>
      {{ end }}
    </section>
    {{ if or (eq .type "text") (eq .type "image") (eq .type "code") }}
    <div id="btm-container">
      {{ if not (eq .page 1) }}
      <a href="/search?q={{ .query }}&page={{ template "dec" .page }}&type={{ .type }}"
        >Previous</a
      >
      {{ end }}
      <a href="/search?q={{ .query }}&page={{ template "inc" .page }}&type={{ .type }}"
        >Next</a
      >
    </div>
    {{ end }} {{ end }}
  </body>
</html>
